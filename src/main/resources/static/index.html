<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API 테스트 페이지</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        form { margin-bottom: 30px; padding: 20px; border: 1px solid #ccc; border-radius: 5px; }
        label { display: block; margin-top: 10px; }
        input, select, textarea { width: 100%; padding: 8px; margin-top: 5px; }
        button { margin-top: 10px; padding: 10px 20px; }
        pre { background-color: #f4f4f4; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>
<h1>API 테스트 페이지</h1>

<!-- 할 일 생성 -->
<form id="createTaskForm">
    <h2>할 일 생성</h2>
    <label for="createTitle">제목:</label>
    <input type="text" id="createTitle" required>
    <label for="createDescription">설명:</label>
    <textarea id="createDescription" required></textarea>
    <label for="createStatus">상태:</label>
    <select id="createStatus" required>
        <option value="todo">Todo</option>
        <option value="ongoing">Ongoing</option>
        <option value="done">Done</option>
        <option value="delay">Delay</option>
    </select>
    <label for="createStartDate">시작일자:</label>
    <input type="date" id="createStartDate" required>
    <label for="createDueDate">마감일자:</label>
    <input type="date" id="createDueDate" required>
    <label for="createEndDate">완료일자:</label>
    <input type="date" id="createEndDate">
    <label for="createTeamId">팀 ID:</label>
    <input type="number" id="createTeamId" required>
    <label for="createUserId">사용자 ID:</label>
    <input type="number" id="createUserId" required>
    <label for="createParentTask">상위 할 일 ID:</label>
    <input type="number" id="createParentTask">
    <button type="submit">생성 요청</button>
</form>

<!-- 특정 할 일 조회 -->
<form id="getTaskForm">
    <h2>특정 할 일 조회</h2>
    <label for="getTaskId">할 일 ID:</label>
    <input type="number" id="getTaskId" required>
    <button type="submit">조회 요청</button>
</form>

<!-- 조건별 할 일 조회 -->
<form id="searchTasksForm">
    <h2>조건별 할 일 조회</h2>
    <label for="searchStatus">상태:</label>
    <select id="searchStatus">
        <option value="">-- 선택하세요 --</option>
        <option value="todo">Todo</option>
        <option value="ongoing">Ongoing</option>
        <option value="done">Done</option>
        <option value="delay">Delay</option>
    </select>
    <label for="searchTeamId">팀 ID:</label>
    <input type="number" id="searchTeamId">
    <label for="searchUserId">사용자 ID:</label>
    <input type="number" id="searchUserId">
    <button type="submit">조회 요청</button>
</form>

<!-- 할 일 수정 -->
<form id="updateTaskForm">
    <h2>할 일 수정</h2>
    <label for="updateTaskId">할 일 ID:</label>
    <input type="number" id="updateTaskId" required>
    <label for="updateTitle">제목:</label>
    <input type="text" id="updateTitle" required>
    <label for="updateDescription">설명:</label>
    <textarea id="updateDescription" required></textarea>
    <label for="updateStatus">상태:</label>
    <select id="updateStatus" required>
        <option value="todo">Todo</option>
        <option value="ongoing">Ongoing</option>
        <option value="done">Done</option>
        <option value="delay">Delay</option>
    </select>
    <label for="updateStartDate">시작일자:</label>
    <input type="date" id="updateStartDate" required>
    <label for="updateDueDate">마감일자:</label>
    <input type="date" id="updateDueDate" required>
    <label for="updateEndDate">완료일자:</label>
    <input type="date" id="updateEndDate">
    <label for="updateTeamId">팀 ID:</label>
    <input type="number" id="updateTeamId" required>
    <label for="updateUserId">사용자 ID:</label>
    <input type="number" id="updateUserId" required>
    <label for="updateParentTask">상위 할 일 ID:</label>
    <input type="number" id="updateParentTask">
    <button type="submit">수정 요청</button>
</form>

<!-- 할 일 삭제 -->
<form id="deleteTaskForm">
    <h2>할 일 삭제</h2>
    <label for="deleteTaskId">할 일 ID:</label>
    <input type="number" id="deleteTaskId" required>
    <button type="submit">삭제 요청</button>
</form>

<h2>응답</h2>
<pre id="response"></pre>

<script>
    const responseElement = document.getElementById('response');

    function updateResponse(message) {
        responseElement.textContent = JSON.stringify(message, null, 2);
    }

    // 할 일 생성 요청
    document.getElementById('createTaskForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const data = {
            title: document.getElementById('createTitle').value,
            description: document.getElementById('createDescription').value,
            status: document.getElementById('createStatus').value,
            startDate: document.getElementById('createStartDate').value,
            dueDate: document.getElementById('createDueDate').value,
            endDate: document.getElementById('createEndDate').value,
            teamId: document.getElementById('createTeamId').value,
            userId: document.getElementById('createUserId').value,
            parentTask: document.getElementById('createParentTask').value
        };

        fetch('/foot/task/create', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
            .then(response => response.json())
            .then(updateResponse)
            .catch(error => updateResponse({ error: '할 일 생성 실패', details: error }));
    });

    // 특정 할 일 조회 요청
    document.getElementById('getTaskForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const taskId = document.getElementById('getTaskId').value;

        fetch(`/foot/task/${taskId}`)
            .then(response => response.json())
            .then(updateResponse)
            .catch(error => updateResponse({ error: '할 일 조회 실패', details: error }));
    });

    // 조건별 할 일 조회 요청
    document.getElementById('searchTasksForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const params = new URLSearchParams();
        const status = document.getElementById('searchStatus').value;
        const teamId = document.getElementById('searchTeamId').value;
        const userId = document.getElementById('searchUserId').value;

        if (status) params.append('status', status);
        if (teamId) params.append('teamId', teamId);
        if (userId) params.append('userId', userId);

        fetch(`/foot/task/search?${params.toString()}`)
            .then(response => response.json())
            .then(updateResponse)
            .catch(error => updateResponse({ error: '조건별 할 일 조회 실패', details: error }));
    });

    // 할 일 수정 요청
    document.getElementById('updateTaskForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const taskId = document.getElementById('updateTaskId').value;
        const data = {
            title: document.getElementById('updateTitle').value,
            description: document.getElementById('updateDescription').value,
            status: document.getElementById('updateStatus').value,
            startDate: document.getElementById('updateStartDate').value,
            dueDate: document.getElementById('updateDueDate').value,
            endDate: document.getElementById('updateEndDate').value,
            teamId: document.getElementById('updateTeamId').value,
            userId: document.getElementById('updateUserId').value,
            parentTask: document.getElementById('updateParentTask').value
        };

        fetch(`/foot/task/update/${taskId}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
            .then(response => response.json())
            .then(updateResponse)
            .catch(error => updateResponse({ error: '할 일 수정 실패', details: error }));
    });

    // 할 일 삭제 요청
    document.getElementById('deleteTaskForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const taskId = document.getElementById('deleteTaskId').value;

        fetch(`/foot/task/delete/${taskId}`, {
            method: 'DELETE'
        })
            .then(response => response.text())
            .then(data => updateResponse({ message: '할 일이 삭제되었습니다.', data }))
            .catch(error => updateResponse({ error: '할 일 삭제 실패', details: error }));
    });
</script>
</body>
</html>
